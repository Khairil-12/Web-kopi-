<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - Sistem E-Commerce</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="dashboard-container">
      <!-- Header -->
      <header class="dashboard-header">
        <div class="header-left">
          <h1><i class="fas fa-store"></i> WEB-ECOMMERCE</h1>
          <div class="user-role-badge" id="userRoleBadge">
            <!-- Badge akan diisi oleh JavaScript -->
          </div>
        </div>
        <div class="header-right">
          <div class="user-info">
            <span id="userName">Admin User</span>
            <div class="avatar">
              <i class="fas fa-user-circle"></i>
            </div>
            <button class="logout-btn" id="logoutBtn">
              <i class="fas fa-sign-out-alt"></i> Keluar
            </button>
          </div>
        </div>
      </header>

      <div class="dashboard-main">
        <!-- Sidebar -->
        <aside class="dashboard-sidebar" id="dashboardSidebar">
          <!-- Sidebar akan diisi berdasarkan role -->
        </aside>

        <!-- Main Content -->
        <main class="dashboard-content">
          <!-- Konten akan diubah berdasarkan menu yang dipilih -->
          <div class="content-header">
            <h2 id="contentTitle">Dashboard</h2>
            <div class="breadcrumb" id="breadcrumb">
              <span>Dashboard</span>
            </div>
          </div>

          <div class="content-body" id="contentBody">
            <!-- Default content: statistik dashboard -->
            <div class="welcome-section">
              <div class="welcome-card">
                <h3>
                  <i class="fas fa-chart-line"></i> Selamat Datang di Dashboard
                </h3>
                <p>
                  Gunakan menu di sebelah kiri untuk mengelola sistem
                  e-commerce.
                </p>
                <div class="stats-grid" id="statsGrid">
                  <!-- Statistik akan diisi berdasarkan role -->
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>

      <!-- Modal untuk tambah/edit produk -->
      <div class="modal" id="productModal">
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="modalTitle">Tambah Produk Baru</h3>
            <button class="modal-close" id="modalClose">&times;</button>
          </div>
          <div class="modal-body">
            <form id="productForm">
              <div class="form-group">
                <label for="productName">Nama Produk</label>
                <input type="text" id="productName" required />
              </div>
              <div class="form-group">
                <label for="productCategory">Kategori</label>
                <select id="productCategory" required>
                  <option value="">Pilih Kategori</option>
                  <option value="elektronik">Elektronik</option>
                  <option value="pakaian">Pakaian</option>
                  <option value="makanan">Makanan & Minuman</option>
                  <option value="rumah-tangga">Rumah Tangga</option>
                  <option value="olahraga">Olahraga</option>
                </select>
              </div>
              <div class="form-group">
                <label for="productPrice">Harga (Rp)</label>
                <input type="number" id="productPrice" min="0" required />
              </div>
              <div class="form-group">
                <label for="productStock">Stok</label>
                <input type="number" id="productStock" min="0" required />
              </div>
              <div class="form-group">
                <label for="productDescription">Deskripsi</label>
                <textarea id="productDescription" rows="4"></textarea>
              </div>
              <div class="form-group">
                <label for="productImage">URL Gambar</label>
                <input
                  type="text"
                  id="productImage"
                  placeholder="https://example.com/image.jpg"
                />
              </div>
              <input type="hidden" id="productId" />
              <div class="form-actions">
                <button type="submit" class="btn-primary">Simpan Produk</button>
                <button type="button" class="btn-secondary" id="cancelBtn">
                  Batal
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Modal konfirmasi -->
      <div class="modal" id="confirmModal">
        <div class="modal-content confirm-modal">
          <div class="modal-header">
            <h3 id="confirmTitle">Konfirmasi</h3>
            <button class="modal-close" id="confirmClose">&times;</button>
          </div>
          <div class="modal-body">
            <p id="confirmMessage">
              Apakah Anda yakin ingin melakukan tindakan ini?
            </p>
          </div>
          <div class="modal-footer">
            <button class="btn-danger" id="confirmAction">Ya, Lanjutkan</button>
            <button class="btn-secondary" id="confirmCancel">Batal</button>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <footer class="dashboard-footer">
        <p>&copy; 2023 WEB-ECOMMERCE. All rights reserved.</p>
        <p class="footer-info">Dashboard v1.0</p>
      </footer>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/script.js"></script>
    <script>
      // Data dummy untuk simulasi
      const sampleUsers = [
        {
          id: 1,
          name: "Ahmad Fauzi",
          email: "ahmad@example.com",
          role: "customer",
          joinDate: "2023-01-15",
          status: "active",
        },
        {
          id: 2,
          name: "Siti Nurhaliza",
          email: "siti@example.com",
          role: "customer",
          joinDate: "2023-02-20",
          status: "active",
        },
        {
          id: 3,
          name: "Budi Santoso",
          email: "budi@example.com",
          role: "customer",
          joinDate: "2023-03-10",
          status: "inactive",
        },
        {
          id: 4,
          name: "Dewi Anggraini",
          email: "dewi@example.com",
          role: "customer",
          joinDate: "2023-04-05",
          status: "active",
        },
        {
          id: 5,
          name: "Rudi Hartono",
          email: "rudi@example.com",
          role: "customer",
          joinDate: "2023-05-12",
          status: "active",
        },
      ];

      const sampleProducts = [
        {
          id: 1,
          name: "Laptop ASUS VivoBook",
          category: "elektronik",
          price: 8500000,
          stock: 12,
          status: "active",
          description: "Laptop dengan prosesor Intel i5 dan RAM 8GB",
        },
        {
          id: 2,
          name: "Smartphone Samsung A54",
          category: "elektronik",
          price: 4500000,
          stock: 25,
          status: "active",
          description: "Smartphone dengan kamera 50MP dan baterai 5000mAh",
        },
        {
          id: 3,
          name: "Kaos Polo T-Shirt",
          category: "pakaian",
          price: 150000,
          stock: 50,
          status: "active",
          description: "Kaos polo dengan bahan katun premium",
        },
        {
          id: 4,
          name: "Kopi Arabika 250gr",
          category: "makanan",
          price: 75000,
          stock: 100,
          status: "inactive",
          description: "Kopi arabika asal Toraja, kemasan 250 gram",
        },
        {
          id: 5,
          name: "Blender Philips",
          category: "rumah-tangga",
          price: 600000,
          stock: 15,
          status: "active",
          description: "Blender dengan 5 kecepatan dan kapasitas 2L",
        },
        {
          id: 6,
          name: "Sepatu Lari Nike",
          category: "olahraga",
          price: 1200000,
          stock: 8,
          status: "active",
          description: "Sepatu lari dengan teknologi Air Cushion",
        },
      ];

      const sampleTransactions = [
        {
          id: 1001,
          userId: 1,
          userName: "Ahmad Fauzi",
          date: "2023-06-10",
          total: 4550000,
          status: "completed",
          items: 2,
        },
        {
          id: 1002,
          userId: 2,
          userName: "Siti Nurhaliza",
          date: "2023-06-12",
          total: 150000,
          status: "completed",
          items: 1,
        },
        {
          id: 1003,
          userId: 4,
          userName: "Dewi Anggraini",
          date: "2023-06-15",
          total: 600000,
          status: "pending",
          items: 1,
        },
        {
          id: 1004,
          userId: 5,
          userName: "Rudi Hartono",
          date: "2023-06-18",
          total: 1200000,
          status: "completed",
          items: 1,
        },
        {
          id: 1005,
          userId: 1,
          userName: "Ahmad Fauzi",
          date: "2023-06-20",
          total: 4500000,
          status: "completed",
          items: 1,
        },
      ];

      const sampleCustomerPurchases = [
        {
          id: 1001,
          date: "2023-06-10",
          productName: "Smartphone Samsung A54",
          quantity: 1,
          price: 4500000,
          total: 4500000,
          status: "completed",
        },
        {
          id: 1002,
          date: "2023-06-10",
          productName: "Kaos Polo T-Shirt",
          quantity: 1,
          price: 150000,
          total: 150000,
          status: "completed",
        },
        {
          id: 1005,
          date: "2023-06-20",
          productName: "Smartphone Samsung A54",
          quantity: 1,
          price: 4500000,
          total: 4500000,
          status: "completed",
        },
      ];

      // State aplikasi
      let currentUserRole = "admin"; // Default, akan diganti dengan data login sesungguhnya
      let currentUserId = 1; // Default, akan diganti dengan data login sesungguhnya
      let currentView = "dashboard";
      let selectedProductId = null;
      let selectedUserId = null;
      let selectedTransactionId = null;

      // Fungsi inisialisasi dashboard
      function initDashboard() {
        // Cek role user dari session atau localStorage
        // Untuk contoh ini, kita akan menggunakan variabel currentUserRole
        // Dalam implementasi sebenarnya, ambil dari auth.js

        setupEventListeners();
        renderSidebar();
        renderStats();
        updateUserInfo();
      }

      // Setup event listeners
      function setupEventListeners() {
        // Logout button
        document
          .getElementById("logoutBtn")
          .addEventListener("click", function () {
            if (confirm("Apakah Anda yakin ingin keluar?")) {
              // Redirect ke halaman login
              window.location.href = "login.html";
            }
          });

        // Modal close buttons
        document
          .getElementById("modalClose")
          .addEventListener("click", closeModal);
        document
          .getElementById("confirmClose")
          .addEventListener("click", closeConfirmModal);
        document
          .getElementById("cancelBtn")
          .addEventListener("click", closeModal);
        document
          .getElementById("confirmCancel")
          .addEventListener("click", closeConfirmModal);

        // Product form submit
        document
          .getElementById("productForm")
          .addEventListener("submit", handleProductSubmit);

        // Close modal when clicking outside
        window.addEventListener("click", function (event) {
          const modal = document.getElementById("productModal");
          const confirmModal = document.getElementById("confirmModal");

          if (event.target === modal) {
            closeModal();
          }

          if (event.target === confirmModal) {
            closeConfirmModal();
          }
        });
      }

      // Render sidebar berdasarkan role
      function renderSidebar() {
        const sidebar = document.getElementById("dashboardSidebar");
        let sidebarContent = "";

        // Update role badge
        const roleBadge = document.getElementById("userRoleBadge");
        roleBadge.innerHTML =
          currentUserRole === "admin"
            ? '<span class="badge-admin"><i class="fas fa-crown"></i> Admin</span>'
            : '<span class="badge-customer"><i class="fas fa-user"></i> Pelanggan</span>';

        if (currentUserRole === "admin") {
          sidebarContent = `
                    <div class="sidebar-menu">
                        <div class="menu-section">
                            <h3><i class="fas fa-tachometer-alt"></i> Dashboard</h3>
                            <ul>
                                <li class="menu-item active" data-view="dashboard">
                                    <i class="fas fa-chart-pie"></i> Dashboard Utama
                                </li>
                            </ul>
                        </div>
                        
                        <div class="menu-section">
                            <h3><i class="fas fa-users"></i> Manajemen User</h3>
                            <ul>
                                <li class="menu-item" data-view="users">
                                    <i class="fas fa-user-friends"></i> Semua Pengguna
                                </li>
                            </ul>
                        </div>
                        
                        <div class="menu-section">
                            <h3><i class="fas fa-box"></i> Manajemen Produk</h3>
                            <ul>
                                <li class="menu-item" data-view="products">
                                    <i class="fas fa-boxes"></i> Semua Produk
                                </li>
                                <li class="menu-item" data-view="add-product">
                                    <i class="fas fa-plus-circle"></i> Tambah Produk
                                </li>
                            </ul>
                        </div>
                        
                        <div class="menu-section">
                            <h3><i class="fas fa-exchange-alt"></i> Transaksi</h3>
                            <ul>
                                <li class="menu-item" data-view="transactions">
                                    <i class="fas fa-shopping-cart"></i> Semua Transaksi
                                </li>
                            </ul>
                        </div>
                    </div>
                `;
        } else {
          sidebarContent = `
                    <div class="sidebar-menu">
                        <div class="menu-section">
                            <h3><i class="fas fa-tachometer-alt"></i> Dashboard</h3>
                            <ul>
                                <li class="menu-item active" data-view="dashboard">
                                    <i class="fas fa-chart-pie"></i> Dashboard Saya
                                </li>
                            </ul>
                        </div>
                        
                        <div class="menu-section">
                            <h3><i class="fas fa-user"></i> Profil Saya</h3>
                            <ul>
                                <li class="menu-item" data-view="profile">
                                    <i class="fas fa-user-circle"></i> Profil Saya
                                </li>
                            </ul>
                        </div>
                        
                        <div class="menu-section">
                            <h3><i class="fas fa-shopping-bag"></i> Pembelian</h3>
                            <ul>
                                <li class="menu-item" data-view="purchases">
                                    <i class="fas fa-history"></i> Riwayat Pembelian
                                </li>
                            </ul>
                        </div>
                    </div>
                `;
        }

        sidebar.innerHTML = sidebarContent;

        // Tambahkan event listener untuk menu items
        const menuItems = sidebar.querySelectorAll(".menu-item");
        menuItems.forEach((item) => {
          item.addEventListener("click", function () {
            // Hapus class active dari semua menu items
            menuItems.forEach((i) => i.classList.remove("active"));
            // Tambahkan class active ke menu item yang diklik
            this.classList.add("active");

            // Ambil view dari data attribute
            const view = this.getAttribute("data-view");
            loadView(view);
          });
        });
      }

      // Render statistik berdasarkan role
      function renderStats() {
        const statsGrid = document.getElementById("statsGrid");
        let statsContent = "";

        if (currentUserRole === "admin") {
          const totalUsers = sampleUsers.length;
          const activeUsers = sampleUsers.filter(
            (u) => u.status === "active"
          ).length;
          const totalProducts = sampleProducts.length;
          const activeProducts = sampleProducts.filter(
            (p) => p.status === "active"
          ).length;
          const totalTransactions = sampleTransactions.length;
          const totalRevenue = sampleTransactions
            .filter((t) => t.status === "completed")
            .reduce((sum, t) => sum + t.total, 0);

          statsContent = `
                    <div class="stat-card">
                        <div class="stat-icon stat-users">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h4>${totalUsers}</h4>
                            <p>Total Pengguna</p>
                        </div>
                        <div class="stat-detail">${activeUsers} Aktif</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon stat-products">
                            <i class="fas fa-boxes"></i>
                        </div>
                        <div class="stat-info">
                            <h4>${totalProducts}</h4>
                            <p>Total Produk</p>
                        </div>
                        <div class="stat-detail">${activeProducts} Aktif</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon stat-transactions">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="stat-info">
                            <h4>${totalTransactions}</h4>
                            <p>Total Transaksi</p>
                        </div>
                        <div class="stat-detail">Terbaru: #${
                          sampleTransactions[0]?.id || "N/A"
                        }</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon stat-revenue">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="stat-info">
                            <h4>Rp ${totalRevenue.toLocaleString("id-ID")}</h4>
                            <p>Total Pendapatan</p>
                        </div>
                        <div class="stat-detail">Dari transaksi selesai</div>
                    </div>
                `;
        } else {
          const userPurchases = sampleCustomerPurchases.filter(
            (p) => p.status === "completed"
          );
          const totalPurchases = userPurchases.length;
          const totalSpent = userPurchases.reduce((sum, p) => sum + p.total, 0);

          statsContent = `
                    <div class="stat-card">
                        <div class="stat-icon stat-purchases">
                            <i class="fas fa-shopping-bag"></i>
                        </div>
                        <div class="stat-info">
                            <h4>${totalPurchases}</h4>
                            <p>Total Pembelian</p>
                        </div>
                        <div class="stat-detail">Item dibeli</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon stat-spent">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="stat-info">
                            <h4>Rp ${totalSpent.toLocaleString("id-ID")}</h4>
                            <p>Total Pengeluaran</p>
                        </div>
                        <div class="stat-detail">Untuk pembelian</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon stat-products">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <div class="stat-info">
                            <h4>${
                              [
                                ...new Set(
                                  userPurchases.map((p) => p.productName)
                                ),
                              ].length
                            }</h4>
                            <p>Produk Dibeli</p>
                        </div>
                        <div class="stat-detail">Jenis produk berbeda</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon stat-last">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="stat-info">
                            <h4>${
                              userPurchases.length > 0
                                ? userPurchases[0].date
                                : "N/A"
                            }</h4>
                            <p>Pembelian Terakhir</p>
                        </div>
                        <div class="stat-detail">Tanggal transaksi</div>
                    </div>
                `;
        }

        statsGrid.innerHTML = statsContent;
      }

      // Update informasi user
      function updateUserInfo() {
        const userNameElement = document.getElementById("userName");

        if (currentUserRole === "admin") {
          userNameElement.textContent = "Admin User";
        } else {
          const customer = sampleUsers.find((u) => u.id === currentUserId);
          userNameElement.textContent = customer ? customer.name : "Pelanggan";
        }
      }

      // Load view berdasarkan pilihan menu
      function loadView(view) {
        currentView = view;
        const contentBody = document.getElementById("contentBody");
        const contentTitle = document.getElementById("contentTitle");
        const breadcrumb = document.getElementById("breadcrumb");

        let content = "";
        let title = "";
        let breadcrumbText = "";

        switch (view) {
          case "dashboard":
            title =
              currentUserRole === "admin"
                ? "Dashboard Admin"
                : "Dashboard Pelanggan";
            breadcrumbText = "<span>Dashboard</span>";
            content = `
                        <div class="welcome-section">
                            <div class="welcome-card">
                                <h3><i class="fas fa-chart-line"></i> ${
                                  currentUserRole === "admin"
                                    ? "Dashboard Admin"
                                    : "Dashboard Pelanggan"
                                }</h3>
                                <p>${
                                  currentUserRole === "admin"
                                    ? "Gunakan menu di sebelah kiri untuk mengelola sistem e-commerce."
                                    : "Selamat datang di dashboard pelanggan. Lihat profil dan riwayat pembelian Anda di sini."
                                }</p>
                                <div class="stats-grid" id="statsGrid">
                                    <!-- Stats akan dirender ulang -->
                                </div>
                            </div>
                        </div>
                    `;
            renderStats();
            break;

          case "users":
            if (currentUserRole !== "admin") return;

            title = "Manajemen Pengguna";
            breadcrumbText =
              '<span>Dashboard</span> <i class="fas fa-chevron-right"></i> <span>Manajemen Pengguna</span>';
            content = renderUsersView();
            break;

          case "products":
            if (currentUserRole !== "admin") return;

            title = "Manajemen Produk";
            breadcrumbText =
              '<span>Dashboard</span> <i class="fas fa-chevron-right"></i> <span>Manajemen Produk</span>';
            content = renderProductsView();
            break;

          case "add-product":
            if (currentUserRole !== "admin") return;

            title = "Tambah Produk Baru";
            breadcrumbText =
              '<span>Dashboard</span> <i class="fas fa-chevron-right"></i> <span>Manajemen Produk</span> <i class="fas fa-chevron-right"></i> <span>Tambah Produk</span>';
            content = renderAddProductView();
            break;

          case "transactions":
            if (currentUserRole !== "admin") return;

            title = "Manajemen Transaksi";
            breadcrumbText =
              '<span>Dashboard</span> <i class="fas fa-chevron-right"></i> <span>Manajemen Transaksi</span>';
            content = renderTransactionsView();
            break;

          case "profile":
            if (currentUserRole === "admin") return;

            title = "Profil Saya";
            breadcrumbText =
              '<span>Dashboard</span> <i class="fas fa-chevron-right"></i> <span>Profil Saya</span>';
            content = renderProfileView();
            break;

          case "purchases":
            if (currentUserRole === "admin") return;

            title = "Riwayat Pembelian";
            breadcrumbText =
              '<span>Dashboard</span> <i class="fas fa-chevron-right"></i> <span>Riwayat Pembelian</span>';
            content = renderPurchasesView();
            break;

          default:
            title = "Dashboard";
            breadcrumbText = "<span>Dashboard</span>";
            content = "<p>View tidak ditemukan.</p>";
        }

        contentTitle.textContent = title;
        breadcrumb.innerHTML = breadcrumbText;
        contentBody.innerHTML = content;

        // Setup event listeners untuk konten yang baru dimuat
        setupContentEventListeners();
      }

      // Render view daftar pengguna (admin only)
      function renderUsersView() {
        return `
                <div class="content-section">
                    <div class="section-header">
                        <h3><i class="fas fa-users"></i> Daftar Pengguna</h3>
                        <p>Kelola data pengguna sistem e-commerce</p>
                    </div>
                    
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nama</th>
                                    <th>Email</th>
                                    <th>Tanggal Bergabung</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                ${sampleUsers
                                  .map(
                                    (user) => `
                                    <tr>
                                        <td>${user.id}</td>
                                        <td>${user.name}</td>
                                        <td>${user.email}</td>
                                        <td>${user.joinDate}</td>
                                        <td>
                                            <span class="status-badge status-${
                                              user.status
                                            }">
                                                ${
                                                  user.status === "active"
                                                    ? "Aktif"
                                                    : "Nonaktif"
                                                }
                                            </span>
                                        </td>
                                        <td class="actions">
                                            <button class="btn-danger btn-sm delete-user-btn" data-id="${
                                              user.id
                                            }">
                                                <i class="fas fa-trash"></i> Hapus
                                            </button>
                                        </td>
                                    </tr>
                                `
                                  )
                                  .join("")}
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="table-info">
                        <p>Total: ${sampleUsers.length} pengguna</p>
                    </div>
                </div>
            `;
      }

      // Render view daftar produk (admin only)
      function renderProductsView() {
        const activeProducts = sampleProducts.filter(
          (p) => p.status === "active"
        );
        const inactiveProducts = sampleProducts.filter(
          (p) => p.status === "inactive"
        );

        return `
                <div class="content-section">
                    <div class="section-header">
                        <h3><i class="fas fa-boxes"></i> Daftar Produk</h3>
                        <div class="section-actions">
                            <button class="btn-primary" id="addProductBtn">
                                <i class="fas fa-plus"></i> Tambah Produk Baru
                            </button>
                        </div>
                    </div>
                    
                    <div class="section-tabs">
                        <button class="tab-btn active" data-tab="active">Produk Aktif (${
                          activeProducts.length
                        })</button>
                        <button class="tab-btn" data-tab="inactive">Produk Nonaktif (${
                          inactiveProducts.length
                        })</button>
                    </div>
                    
                    <div class="tab-content active" id="tab-active">
                        <div class="products-grid">
                            ${activeProducts
                              .map(
                                (product) => `
                                <div class="product-card">
                                    <div class="product-image">
                                        <img src="${
                                          product.image ||
                                          "https://via.placeholder.com/300x200?text=Produk"
                                        }" alt="${product.name}">
                                        <span class="product-status status-active">Aktif</span>
                                    </div>
                                    <div class="product-info">
                                        <h4>${product.name}</h4>
                                        <p class="product-category">${
                                          product.category
                                        }</p>
                                        <p class="product-description">${
                                          product.description
                                        }</p>
                                        <div class="product-footer">
                                            <div class="product-price">
                                                <strong>Rp ${product.price.toLocaleString(
                                                  "id-ID"
                                                )}</strong>
                                                <span>Stok: ${
                                                  product.stock
                                                }</span>
                                            </div>
                                            <div class="product-actions">
                                                <button class="btn-secondary btn-sm edit-product-btn" data-id="${
                                                  product.id
                                                }">
                                                    <i class="fas fa-edit"></i> Edit
                                                </button>
                                                <button class="btn-warning btn-sm deactivate-product-btn" data-id="${
                                                  product.id
                                                }">
                                                    <i class="fas fa-eye-slash"></i> Nonaktifkan
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                    </div>
                    
                    <div class="tab-content" id="tab-inactive">
                        <div class="products-grid">
                            ${inactiveProducts
                              .map(
                                (product) => `
                                <div class="product-card">
                                    <div class="product-image">
                                        <img src="${
                                          product.image ||
                                          "https://via.placeholder.com/300x200?text=Produk"
                                        }" alt="${product.name}">
                                        <span class="product-status status-inactive">Nonaktif</span>
                                    </div>
                                    <div class="product-info">
                                        <h4>${product.name}</h4>
                                        <p class="product-category">${
                                          product.category
                                        }</p>
                                        <p class="product-description">${
                                          product.description
                                        }</p>
                                        <div class="product-footer">
                                            <div class="product-price">
                                                <strong>Rp ${product.price.toLocaleString(
                                                  "id-ID"
                                                )}</strong>
                                                <span>Stok: ${
                                                  product.stock
                                                }</span>
                                            </div>
                                            <div class="product-actions">
                                                <button class="btn-secondary btn-sm edit-product-btn" data-id="${
                                                  product.id
                                                }">
                                                    <i class="fas fa-edit"></i> Edit
                                                </button>
                                                <button class="btn-success btn-sm activate-product-btn" data-id="${
                                                  product.id
                                                }">
                                                    <i class="fas fa-eye"></i> Aktifkan
                                                </button>
                                                <button class="btn-danger btn-sm delete-product-btn" data-id="${
                                                  product.id
                                                }">
                                                    <i class="fas fa-trash"></i> Hapus
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                    </div>
                </div>
            `;
      }

      // Render view tambah produk (admin only)
      function renderAddProductView() {
        // Kosongkan form produk
        document.getElementById("productForm").reset();
        document.getElementById("productId").value = "";
        document.getElementById("modalTitle").textContent =
          "Tambah Produk Baru";

        // Tampilkan modal
        document.getElementById("productModal").style.display = "block";

        // Kembalikan konten default
        return `
                <div class="content-section">
                    <div class="section-header">
                        <h3><i class="fas fa-plus-circle"></i> Tambah Produk Baru</h3>
                        <p>Isi formulir di bawah untuk menambahkan produk baru</p>
                    </div>
                    
                    <div class="empty-state">
                        <i class="fas fa-edit fa-3x"></i>
                        <h3>Form Tambah Produk</h3>
                        <p>Form tambah produk telah ditampilkan di modal. Silakan isi informasi produk.</p>
                        <button class="btn-primary" id="openProductForm">
                            <i class="fas fa-plus"></i> Tampilkan Form Lagi
                        </button>
                    </div>
                </div>
            `;
      }

      // Render view transaksi (admin only)
      function renderTransactionsView() {
        return `
                <div class="content-section">
                    <div class="section-header">
                        <h3><i class="fas fa-shopping-cart"></i> Daftar Transaksi</h3>
                        <p>Kelola semua transaksi yang dilakukan pelanggan</p>
                    </div>
                    
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID Transaksi</th>
                                    <th>Pelanggan</th>
                                    <th>Tanggal</th>
                                    <th>Jumlah Item</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="transactionsTableBody">
                                ${sampleTransactions
                                  .map(
                                    (transaction) => `
                                    <tr>
                                        <td>#${transaction.id}</td>
                                        <td>${transaction.userName}</td>
                                        <td>${transaction.date}</td>
                                        <td>${transaction.items}</td>
                                        <td>Rp ${transaction.total.toLocaleString(
                                          "id-ID"
                                        )}</td>
                                        <td>
                                            <span class="status-badge status-${
                                              transaction.status
                                            }">
                                                ${
                                                  transaction.status ===
                                                  "completed"
                                                    ? "Selesai"
                                                    : "Pending"
                                                }
                                            </span>
                                        </td>
                                        <td class="actions">
                                            <button class="btn-secondary btn-sm view-transaction-btn" data-id="${
                                              transaction.id
                                            }">
                                                <i class="fas fa-eye"></i> Detail
                                            </button>
                                        </td>
                                    </tr>
                                `
                                  )
                                  .join("")}
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="table-info">
                        <p>Total: ${sampleTransactions.length} transaksi</p>
                    </div>
                </div>
            `;
      }

      // Render view profil (customer only)
      function renderProfileView() {
        const customer = sampleUsers.find((u) => u.id === currentUserId) || {};

        return `
                <div class="content-section">
                    <div class="section-header">
                        <h3><i class="fas fa-user-circle"></i> Profil Saya</h3>
                        <p>Kelola informasi profil Anda</p>
                    </div>
                    
                    <div class="profile-container">
                        <div class="profile-card">
                            <div class="profile-header">
                                <div class="profile-avatar">
                                    <i class="fas fa-user-circle fa-4x"></i>
                                </div>
                                <div class="profile-info">
                                    <h3>${customer.name || "Pelanggan"}</h3>
                                    <p class="profile-email">${
                                      customer.email || "email@example.com"
                                    }</p>
                                    <span class="badge-customer"><i class="fas fa-user"></i> Pelanggan</span>
                                </div>
                            </div>
                            
                            <div class="profile-details">
                                <div class="detail-row">
                                    <span class="detail-label"><i class="fas fa-calendar-alt"></i> Tanggal Bergabung</span>
                                    <span class="detail-value">${
                                      customer.joinDate || "2023-01-01"
                                    }</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label"><i class="fas fa-user-check"></i> Status Akun</span>
                                    <span class="detail-value status-active">Aktif</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label"><i class="fas fa-shopping-bag"></i> Total Pembelian</span>
                                    <span class="detail-value">${
                                      sampleCustomerPurchases.length
                                    } item</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label"><i class="fas fa-money-bill-wave"></i> Total Pengeluaran</span>
                                    <span class="detail-value">Rp ${sampleCustomerPurchases
                                      .reduce((sum, p) => sum + p.total, 0)
                                      .toLocaleString("id-ID")}</span>
                                </div>
                            </div>
                            
                            <div class="profile-actions">
                                <button class="btn-primary">
                                    <i class="fas fa-edit"></i> Edit Profil
                                </button>
                                <button class="btn-secondary">
                                    <i class="fas fa-key"></i> Ganti Password
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
      }

      // Render view riwayat pembelian (customer only)
      function renderPurchasesView() {
        return `
                <div class="content-section">
                    <div class="section-header">
                        <h3><i class="fas fa-history"></i> Riwayat Pembelian</h3>
                        <p>Lihat semua item yang sudah Anda beli</p>
                    </div>
                    
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID Transaksi</th>
                                    <th>Tanggal</th>
                                    <th>Nama Produk</th>
                                    <th>Jumlah</th>
                                    <th>Harga Satuan</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="purchasesTableBody">
                                ${sampleCustomerPurchases
                                  .map(
                                    (purchase) => `
                                    <tr>
                                        <td>#${purchase.id}</td>
                                        <td>${purchase.date}</td>
                                        <td>${purchase.productName}</td>
                                        <td>${purchase.quantity}</td>
                                        <td>Rp ${purchase.price.toLocaleString(
                                          "id-ID"
                                        )}</td>
                                        <td>Rp ${purchase.total.toLocaleString(
                                          "id-ID"
                                        )}</td>
                                        <td>
                                            <span class="status-badge status-${
                                              purchase.status
                                            }">
                                                ${
                                                  purchase.status ===
                                                  "completed"
                                                    ? "Selesai"
                                                    : "Pending"
                                                }
                                            </span>
                                        </td>
                                    </tr>
                                `
                                  )
                                  .join("")}
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="table-info">
                        <p>Total: ${
                          sampleCustomerPurchases.length
                        } pembelian</p>
                    </div>
                    
                    <div class="summary-card">
                        <h4><i class="fas fa-receipt"></i> Ringkasan Pembelian</h4>
                        <div class="summary-row">
                            <span>Total Item Dibeli:</span>
                            <strong>${sampleCustomerPurchases.length}</strong>
                        </div>
                        <div class="summary-row">
                            <span>Total Pengeluaran:</span>
                            <strong>Rp ${sampleCustomerPurchases
                              .reduce((sum, p) => sum + p.total, 0)
                              .toLocaleString("id-ID")}</strong>
                        </div>
                    </div>
                </div>
            `;
      }

      // Setup event listeners untuk konten yang baru dimuat
      function setupContentEventListeners() {
        // Tab buttons untuk produk
        const tabButtons = document.querySelectorAll(".tab-btn");
        tabButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const tabId = this.getAttribute("data-tab");

            // Update active tab
            tabButtons.forEach((btn) => btn.classList.remove("active"));
            this.classList.add("active");

            // Show corresponding tab content
            document.querySelectorAll(".tab-content").forEach((content) => {
              content.classList.remove("active");
            });
            document.getElementById(`tab-${tabId}`).classList.add("active");
          });
        });

        // Add product button
        const addProductBtn = document.getElementById("addProductBtn");
        if (addProductBtn) {
          addProductBtn.addEventListener("click", function () {
            loadView("add-product");
          });
        }

        // Open product form button
        const openProductForm = document.getElementById("openProductForm");
        if (openProductForm) {
          openProductForm.addEventListener("click", function () {
            document.getElementById("productModal").style.display = "block";
          });
        }

        // Edit product buttons
        const editProductBtns = document.querySelectorAll(".edit-product-btn");
        editProductBtns.forEach((button) => {
          button.addEventListener("click", function () {
            const productId = parseInt(this.getAttribute("data-id"));
            editProduct(productId);
          });
        });

        // Deactivate product buttons
        const deactivateProductBtns = document.querySelectorAll(
          ".deactivate-product-btn"
        );
        deactivateProductBtns.forEach((button) => {
          button.addEventListener("click", function () {
            const productId = parseInt(this.getAttribute("data-id"));
            selectedProductId = productId;
            showConfirmModal(
              "Nonaktifkan Produk",
              "Apakah Anda yakin ingin menonaktifkan produk ini? Produk akan disembunyikan dari katalog.",
              deactivateProduct
            );
          });
        });

        // Activate product buttons
        const activateProductBtns = document.querySelectorAll(
          ".activate-product-btn"
        );
        activateProductBtns.forEach((button) => {
          button.addEventListener("click", function () {
            const productId = parseInt(this.getAttribute("data-id"));
            selectedProductId = productId;
            showConfirmModal(
              "Aktifkan Produk",
              "Apakah Anda yakin ingin mengaktifkan kembali produk ini?",
              activateProduct
            );
          });
        });

        // Delete product buttons
        const deleteProductBtns = document.querySelectorAll(
          ".delete-product-btn"
        );
        deleteProductBtns.forEach((button) => {
          button.addEventListener("click", function () {
            const productId = parseInt(this.getAttribute("data-id"));
            selectedProductId = productId;
            showConfirmModal(
              "Hapus Produk",
              "Apakah Anda yakin ingin menghapus produk ini secara permanen? Tindakan ini tidak dapat dibatalkan.",
              deleteProduct
            );
          });
        });

        // Delete user buttons
        const deleteUserBtns = document.querySelectorAll(".delete-user-btn");
        deleteUserBtns.forEach((button) => {
          button.addEventListener("click", function () {
            const userId = parseInt(this.getAttribute("data-id"));
            selectedUserId = userId;
            showConfirmModal(
              "Hapus Pengguna",
              "Apakah Anda yakin ingin menghapus pengguna ini? Semua data pengguna akan dihapus permanen.",
              deleteUser
            );
          });
        });

        // View transaction buttons
        const viewTransactionBtns = document.querySelectorAll(
          ".view-transaction-btn"
        );
        viewTransactionBtns.forEach((button) => {
          button.addEventListener("click", function () {
            const transactionId = parseInt(this.getAttribute("data-id"));
            selectedTransactionId = transactionId;
            alert(
              `Detail transaksi #${transactionId} akan ditampilkan di sini.`
            );
          });
        });
      }

      // Fungsi untuk edit produk
      function editProduct(productId) {
        const product = sampleProducts.find((p) => p.id === productId);
        if (!product) return;

        // Isi form dengan data produk
        document.getElementById("productId").value = product.id;
        document.getElementById("productName").value = product.name;
        document.getElementById("productCategory").value = product.category;
        document.getElementById("productPrice").value = product.price;
        document.getElementById("productStock").value = product.stock;
        document.getElementById("productDescription").value =
          product.description;
        document.getElementById("productImage").value = product.image || "";
        document.getElementById("modalTitle").textContent = "Edit Produk";

        // Tampilkan modal
        document.getElementById("productModal").style.display = "block";
      }

      // Handle submit form produk
      function handleProductSubmit(e) {
        e.preventDefault();

        const productId = document.getElementById("productId").value;
        const productData = {
          name: document.getElementById("productName").value,
          category: document.getElementById("productCategory").value,
          price: parseInt(document.getElementById("productPrice").value),
          stock: parseInt(document.getElementById("productStock").value),
          description: document.getElementById("productDescription").value,
          image: document.getElementById("productImage").value,
          status: "active",
        };

        if (productId) {
          // Edit produk yang sudah ada
          alert(`Produk dengan ID ${productId} berhasil diperbarui!`);
        } else {
          // Tambah produk baru
          alert("Produk baru berhasil ditambahkan!");
        }

        // Tutup modal
        closeModal();

        // Reload view produk jika sedang di view produk
        if (currentView === "products" || currentView === "add-product") {
          loadView("products");
        }
      }

      // Deactivate product
      function deactivateProduct() {
        alert(`Produk dengan ID ${selectedProductId} dinonaktifkan.`);
        closeConfirmModal();
        loadView("products");
      }

      // Activate product
      function activateProduct() {
        alert(`Produk dengan ID ${selectedProductId} diaktifkan kembali.`);
        closeConfirmModal();
        loadView("products");
      }

      // Delete product
      function deleteProduct() {
        alert(`Produk dengan ID ${selectedProductId} dihapus permanen.`);
        closeConfirmModal();
        loadView("products");
      }

      // Delete user
      function deleteUser() {
        alert(`Pengguna dengan ID ${selectedUserId} dihapus permanen.`);
        closeConfirmModal();
        loadView("users");
      }

      // Tampilkan modal konfirmasi
      function showConfirmModal(title, message, actionCallback) {
        document.getElementById("confirmTitle").textContent = title;
        document.getElementById("confirmMessage").textContent = message;
        document.getElementById("confirmModal").style.display = "block";

        // Hapus event listener sebelumnya dan tambahkan yang baru
        const confirmActionBtn = document.getElementById("confirmAction");
        confirmActionBtn.replaceWith(confirmActionBtn.cloneNode(true));
        document
          .getElementById("confirmAction")
          .addEventListener("click", function () {
            actionCallback();
          });
      }

      // Tutup modal
      function closeModal() {
        document.getElementById("productModal").style.display = "none";
        document.getElementById("productForm").reset();
        document.getElementById("productId").value = "";
      }

      // Tutup modal konfirmasi
      function closeConfirmModal() {
        document.getElementById("confirmModal").style.display = "none";
      }

      // Inisialisasi dashboard saat halaman dimuat
      document.addEventListener("DOMContentLoaded", function () {
        // Untuk simulasi, kita bisa ganti role di sini
        // currentUserRole = 'customer'; // Coba ganti ke 'customer' untuk melihat dashboard pelanggan
        // currentUserId = 1; // ID pelanggan

        initDashboard();
      });
    </script>
  </body>
</html>
